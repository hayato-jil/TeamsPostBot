"use strict";(self.webpackChunk_msteams_sidecars_chat_zero_state=self.webpackChunk_msteams_sidecars_chat_zero_state||[]).push([[575],{973:(t,e,a)=>{a.d(e,{L:()=>mt});var n=a(8738),i=a(1197),r=a.n(i),o=a(3131),s=a(4770),l=a(2940),c=a(7058);const m=(0,a(7603).Se)(),d=(t,e)=>(0,l.I)(t,e),p=(t,e)=>(0,c._)(t,e);var g=a(6926),u=a(1737),h=a(2584),x=a(7352),_=a(5684),f=a(2254),w=a(9118),y=a(8712),C=a(8749),S=a(3277),b=a(4640);const v="8px",j="10px",k="15px",L="30px",F=(0,S.n)({flex:{display:"flex"},inline:{display:"inline-flex"},column:{flexDirection:"column"},alignItemsFlexStart:{alignItems:"flex-start"},alignItemsCenter:{alignItems:"center"},alignItemsFlexEnd:{alignItems:"flex-end"},alignItemsStretch:{alignItems:"stretch"},justifyContentFlexStart:{justifyContent:"flex-start"},justifyContentCenter:{justifyContent:"center"},justifyContentFlexEnd:{justifyContent:"flex-end"},justifyContentStretch:{justifyContent:"stretch"},justifyContentSpaceAround:{justifyContent:"space-around"},justifyContentSpaceBetween:{justifyContent:"space-between"},justifyContentSpaceEvenly:{justifyContent:"space-evenly"},wrap:{flexWrap:"wrap"},fill:{width:"100%",height:"100%"},gapForColumnFlexSmall:{rowGap:j},gapForColumnFlexSmaller:{rowGap:v},gapForColumnFlexMedium:{rowGap:k},gapForColumnFlexLarge:{rowGap:L},gapForRowFlexSmall:{columnGap:j},gapForRowFlexSmaller:{columnGap:v},gapForRowFlexMedium:{columnGap:k},gapForRowFlexLarge:{columnGap:L},paddingMedium:{...b.Pt.padding("10px")}}),T=i.forwardRef((function(t,e){const{children:a,column:r,fill:o,gap:l,hAlign:c,inline:m,padding:d,space:p,vAlign:g,wrap:u,className:h,...x}=t,_=F(),f=i.useMemo((()=>({alignItems:{start:_.alignItemsFlexStart,center:_.alignItemsCenter,end:_.alignItemsFlexEnd,stretch:_.alignItemsStretch},justifyContent:{start:_.justifyContentFlexStart,center:_.justifyContentCenter,end:_.justifyContentFlexEnd,stretch:_.justifyContentStretch},justifyContentSpace:{around:_.justifyContentSpaceAround,between:_.justifyContentSpaceBetween,evenly:_.justifyContentSpaceEvenly},gapForColumnFlex:{"gap.smaller":_.gapForColumnFlexSmaller,"gap.small":_.gapForColumnFlexSmall,"gap.medium":_.gapForColumnFlexMedium,"gap.large":_.gapForColumnFlexLarge},gapRow:{"gap.smaller":_.gapForRowFlexSmaller,"gap.small":_.gapForRowFlexSmall,"gap.medium":_.gapForRowFlexMedium,"gap.large":_.gapForRowFlexLarge},paddings:{"padding.medium":_.paddingMedium}})),[_]),w=(0,s.z)("fui-Flex",_.flex,m&&_.inline,r&&_.column,c&&(r?f.alignItems[c]:f.justifyContent[c]),g&&(r?f.justifyContent[g]:f.alignItems[g]),p&&f.justifyContentSpace[p],u&&_.wrap,o&&_.fill,l&&(r?f.gapForColumnFlex[l]:f.gapRow[l]),d&&f.paddings[d],h),y=i.Children.map(a,(t=>{const e=t;return!!e?.type?.__isFlexItem?i.cloneElement(t,{flexDirection:r?"column":"row"}):t}));return(0,n.jsx)("div",{ref:e,className:w,...x,children:y})}));T.displayName="Flex";const I=i.forwardRef((function(t,e){const{as:a="div",...i}=t,r="string"==typeof t.children?"auto":void 0,o=(0,s.z)("fui-Primitive",t.className);return(0,n.jsx)(a,{dir:r,...i,className:o,ref:e})}));I.displayName="Primitive";var N=a(2996);const E=(0,S.n)({card:{rowGap:"0",flexGrow:"1",flexShrink:"1",flexBasis:"0%",...b.Pt.padding("0"),"@media (min-height: 480px)":{"@container slot-container (min-width: 480px)":{maxWidth:"268px"},"@container slot-container (min-width: 640px)":{maxWidth:"260px"}}},singleCard:{"@media (min-height: 480px)":{"@container slot-container (min-width: 480px)":{maxWidth:"auto"},"@container slot-container (min-width: 640px)":{maxWidth:"auto"}}},cardHeader:{display:"none",flexDirection:"row",justifyContent:"center",marginLeft:"auto",marginRight:"auto","@media (min-height: 480px)":{display:"flex",width:"52px",height:"52px",marginBottom:C.L.spacingVerticalS,"@container slot-container (min-width: 360px)":{width:"64px",height:"64px"},"@container slot-container (min-width: 480px)":{marginBottom:C.L.spacingVerticalL},"@container slot-container (min-width: 640px)":{width:"128px",height:"128px"}},"@media (min-height: 568px)":{width:"52px",height:"52px","@container slot-container (min-width: 360px)":{width:"64px",height:"64px"},"@container slot-container (min-width: 640px)":{width:"128px",height:"128px"},"@container slot-container (min-width: 947px)":{width:"192px",height:"192px"}}},singleCardHeader:{"@media (min-height: 480px)":{width:"128px",height:"128px","@container slot-container (min-width: 360px)":{width:"192px",height:"192px"}},"@media (min-height: 568px)":{width:"192px",height:"192px","@container slot-container (min-width: 360px)":{width:"192px",height:"192px"}}},cardBody:{textAlign:"center",marginBottom:C.L.spacingVerticalS,"@media (min-height: 480px)":{marginBottom:C.L.spacingVerticalL,"@container slot-container (min-width: 947px)":{marginBottom:C.L.spacingVerticalXXL}}},cardFooter:{display:"flex",flexDirection:"row",justifyContent:"center"},img:{objectFit:"contain",width:"100%",...b.Pt.margin(0)},statePopoverSurface:{"@media (min-height: 480px)":{width:"292px"},"@media (max-height: 479px)":{width:"auto"}},statePopoverWrapper:{display:"flex",columnGap:C.L.spacingHorizontalS,alignItems:"center"},singleActionTitle:{marginBottom:C.L.spacingVerticalXXL,fontSize:C.L.fontSizeBase600},singleActionSubtitle:{fontSize:C.L.fontSizeBase300},singleActionButton:{minWidth:"200px"}});var B=a(1603),z=a(6897),A=a(1262);const P=()=>(0,i.useContext)(A.UserContext),R=(t,e)=>{const a=P(),n=a?.coreSettings,r=function(t){const e=(0,i.useRef)(t);(0,z.isEqual)(e.current,t)||(e.current=t);return e.current}(e),[o,s]=(0,i.useState)(n.get(t,r));return(0,i.useEffect)((()=>{if(!n)return;const e=n.getObservable(t,r).subscribe(s);return()=>e.unsubscribe()}),[n,t,r]),o};const M=r().memo((t=>{const{imageUrl:e,title:a,subtitle:l,buttonText:c,buttonAppearance:m,isSingleCta:d,loadingStateText:p,successStateText:S,errorStateText:b,onClick:v,button:j,dataTid:k,telemetry:L={}}=t,F=E(),[z,A]=(0,i.useState)(!1),[R,M]=(0,i.useState)(!1),[V,X]=(0,i.useState)(!1),G=r().useRef(null),$=r().useRef(null),{host:W}=P(),D=r().useCallback((async()=>{if(v){M(!0),A(!1),X(!1);try{const t=await v(),e=W?.navigator?.clipboard;"string"==typeof t&&t.length>0&&e?.writeText?await e.writeText(t):X(!0),G.current=setTimeout((()=>{A(!0),M(!1),$.current=setTimeout((()=>A(!1)),2e3)}),700)}catch(t){M(!1),A(!1),X(!0),$.current=setTimeout((()=>X(!1)),2e3)}}}),[v,W]);return r().useEffect((()=>()=>{G.current&&clearTimeout(G.current),$.current&&clearTimeout($.current)}),[]),(0,n.jsxs)(g.Z,{className:d?(0,s.z)(F.card,F.singleCard):F.card,appearance:B.b.Subtle,"data-tid":k,children:[(0,n.jsx)(u.a,{className:d?(0,s.z)(F.cardHeader,F.singleCardHeader):F.cardHeader,image:{as:"img",src:e,className:F.img}}),(0,n.jsxs)(T,{column:!0,hAlign:"center",className:F.cardBody,children:[a&&(0,n.jsx)(o.E,{size:300,weight:"bold",align:"center",className:d?F.singleActionTitle:void 0,children:a}),(0,n.jsx)(o.E,{size:400,weight:"regular",align:"center",className:d?F.singleActionSubtitle:void 0,children:l})]}),(0,n.jsx)(h.w,{className:F.cardFooter,children:j||(0,n.jsxs)(x.A,{open:z||R,size:"small",positioning:"below",children:[(0,n.jsx)(_.W,{disableButtonEnhancement:!0,children:(0,n.jsx)(f.$,{onClick:D,disabled:R,className:d?F.singleActionButton:void 0,appearance:m,...L,children:c})}),(0,n.jsx)(w.H,{tabIndex:-1,className:F.statePopoverSurface,children:(0,n.jsx)(I,{className:F.statePopoverWrapper,children:R?(0,n.jsx)(y.y,{size:"tiny",label:p}):V?(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(o.E,{size:300,weight:"semibold",align:"start",children:b})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(N.gcm,{fontSize:C.L.fontSizeBase400,primaryFill:C.L.colorPaletteGreenForeground3}),(0,n.jsx)(o.E,{size:300,weight:"semibold",align:"start",children:S})]})})})]})})]})}));M.displayName="CtaCard";var V=a(9761);const X=()=>(0,i.useContext)(V.I18nContext);var G=a(5974),$=a(1240),W=a(8163),D=a(155),O=a(57),H=a(6819);const U={};function q(t,e){return U[t+e]||(U[t+e]=(0,O.l)((0,H.wE)(`.${t} {${e} }`),O.A)),U[t+e]}const J=(t,e)=>{const a=`sidecar-${e}`;return{renderer:((t,e)=>{const{specificityId:a}=e,n=(0,$.I)(t,{...e,styleElementAttributes:{...e.styleElementAttributes??{},"data-enhanced-specificity":"true"}});return{...n,insertCSSRules(t){const e=Object.fromEntries(Object.entries(t).map((([t,e])=>[t,e.map((t=>"string"==typeof t?q(a,t):[q(a,t[0]),t[1]]))])));n.insertCSSRules(e)}}})(t,{specificityId:a,insertionPoint:t.head.firstChild}),className:a}},K=({sidecarName:t,children:e})=>{const{targetDocument:a=document}=(0,D.useFluent_unstable)(),r=(0,i.useMemo)((()=>J(a,t)),[t,a]),{renderer:o,className:s}=r,l=(0,i.useMemo)((()=>{const t=a.createElement("div");return t.classList.add(s),a.body.appendChild(t),t}),[s,a]);return(0,i.useEffect)((()=>()=>{l.remove()}),[l]),(0,n.jsx)(W.H,{renderer:o,children:(0,n.jsx)(D.PortalMountNodeProvider,{value:l,children:(0,n.jsx)("div",{className:s,style:{height:"100%",overflow:"auto",scrollbarGutter:"auto"},children:e})})})},Z=(0,S.n)({paneWrapper:{overflowY:"auto",width:"100%",minHeight:"100%",height:"auto",maxWidth:"664px",boxSizing:"border-box",marginLeft:"auto",marginRight:"auto",...b.Pt.padding(C.L.spacingVerticalM),"@media (min-height: 480px)":{"@container slot-container (min-width: 360px)":{...b.Pt.padding(C.L.spacingVerticalXL)},"@container slot-container (min-width: 480px)":{...b.Pt.padding(C.L.spacingVerticalXXXL)}}},headerContainer:{marginBottom:C.L.spacingVerticalL,"@media (min-height: 480px)":{"@container slot-container (min-width: 290px)":{marginBottom:C.L.spacingVerticalXXL},"@container slot-container (min-width: 480px)":{marginBottom:C.L.spacingVerticalL},"@container slot-container (min-width: 947px)":{marginBottom:C.L.spacingVerticalXXL}},"@media (min-height: 568px)":{"@container slot-container (min-width: 290px)":{marginBottom:C.L.spacingVerticalXXL},"@container slot-container (min-width: 480px)":{marginBottom:C.L.spacingVerticalL},"@container slot-container (min-width: 947px)":{marginBottom:"64px"}}},cardsWrapper:{marginBottom:C.L.spacingVerticalL,"@media (min-height: 480px)":{marginBottom:C.L.spacingVerticalXXL,"@container slot-container (min-width: 480px)":{marginBottom:"40px"}},"@media (min-height: 568px)":{"@container slot-container (min-width: 640px)":{marginBottom:"64px"}}},singleCardWrapper:{"@media (min-height: 568px)":{"@container slot-container (min-width: 640px)":{marginBottom:"80px"}}},cardsContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",width:"100%",columnGap:C.L.spacingVerticalXXL,rowGap:C.L.spacingHorizontalXXL,"@media (min-height: 480px)":{columnGap:C.L.spacingVerticalXXXL,rowGap:C.L.spacingHorizontalXXXL,"@container slot-container (min-width: 480px)":{flexDirection:"row",alignItems:"baseline",columnGap:"40px"}},"@media (min-height: 568px)":{"@container slot-container (min-width: 947px)":{columnGap:"80px"}}},cardTitle:{fontSize:"18px",marginBottom:C.L.spacingVerticalXS,"@media (min-height: 480px)":{"@container slot-container (min-width: 480px)":{marginBottom:C.L.spacingVerticalS}}},footerContainer:{rowGap:C.L.spacingVerticalS},footerLink:{color:C.L.colorBrandForeground1,"&:link, &:visited":{color:C.L.colorBrandForeground1}}});const Q=a(9120).J1`
  query userInviteLink {
    userInviteLink
  }
`;const Y={reason:B.Id};class tt{errorToTelemetry(t,e,a,n){this.logger.errorToTelemetry?.(t,e,this.getEventData(a),n??!0)}getEventData(t){return{...Y,...t}}constructor(t){var e,a,n;n=void 0,(a="logger")in(e=this)?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,this.logger=t}}const et=t=>{const{loggerFactory:e}=P(),a=r().useMemo((()=>{const a=e.newLogger(t,"chat-zero-state");return new tt(a)}),[t,e]);return r().useMemo((()=>({logger:a})),[a])};const at="https://aka.ms/downloadteams",nt=new URL(globalThis.__webpack_public_path__).origin,it={light:"l",dark:"d",contrast:"d"},rt={"data-track-event-identifier":B.Id},ot={"data-track-action-gesture":"click","data-track-action-outcome":"openNewChat","data-track-action-scenario":"newChatCreation","data-track-action-scenario-type":"chatCreation","data-track-module-name":"splashScreenEmptyStateNewChatButton","data-track-module-type":"button","data-track-panel-region":"main","data-track-panel-type":"SplashScreenEmptyState",...rt},st={"data-track-action-gesture":"click","data-track-action-outcome":"inviteToChat","data-track-action-scenario":"inviteToChatAtion","data-track-action-scenario-type":"inviteAtion","data-track-module-name":"splashScreenEmptyStateInviteToChatButton","data-track-module-type":"button","data-track-panel-region":"main","data-track-panel-type":"SplashScreenEmptyState",...rt},lt={"data-track-action-gesture":"click","data-track-action-outcome":"singleInviteToChat","data-track-action-scenario":"singleInviteToChatAtion","data-track-action-scenario-type":"inviteAtion","data-track-module-name":"splashScreenEmptyStateSingleInviteToChatButton","data-track-module-type":"button","data-track-panel-region":"main","data-track-panel-type":"SplashScreenEmptyState",...rt},ct={"data-track-action-gesture":"click","data-track-action-outcome":"openMobileDownload","data-track-action-scenario":"openMobileDownload","data-track-action-scenario-type":"mobileDownload","data-track-module-name":"splashScreenEmptyStateMobileLinkButton","data-track-module-type":"button","data-track-panel-region":"main","data-track-panel-type":"SplashScreenEmptyState",...rt};function mt(t){return(0,n.jsx)(K,{sidecarName:B.U,children:(0,n.jsx)(pt,{...t})})}const dt=m("#graphql\n  query ChatZeroStateMsaMeProfileQuery($forceRefresh: Boolean!) {\n    msaMeProfile(forceRefresh: $forceRefresh) {\n      displayName\n    }\n  }\n");function pt(t){const{MeetNowButton:e,themeType:a,offNetworkUserDisplayName:l}=t,c=Z(),m=X(),g=r().useMemo((()=>m.getTransForNs("messaging")),[m]),{entityCommanding:u}=P(),{allowPrivateMeetNowPolicy:h}=R(G.w.Calling,["allowPrivateMeetNowPolicy"]),{enableChatEmptyStateInviteToChatCta:x,enableOnlyChatEmptyStateInviteToChatCta:_}=R(G.w.Messaging,["enableChatEmptyStateInviteToChatCta","enableOnlyChatEmptyStateInviteToChatCta"]),f=d(dt,{variables:{forceRefresh:!1}}),w=f?.data?.msaMeProfile?.displayName,y=!!l,C=y?m.translate("messaging","chat_empty_state_offnetwork_user_title",{user:l}):m.translate("messaging","chat_empty_state_invite_to_chat_title"),S=y?m.translate("messaging","chat_empty_state_offnetwork_user_description"):m.translate("messaging","chat_empty_state_invite_to_chat_subtitle_single_cta"),b=r().useCallback((()=>{u.chat.chatById("newchat",{entityCommand:{stateTransition:"forceFlush",visibilityState:"show",correlation:{id:Math.floor(Math.random()*Math.pow(10,16)).toString(16),source:"sidecar-chat-zero-state-default",startTimestamp:Date.now()}}})}),[u]),{onInviteToChatHandler:v}=function(){const{logger:t}=et("FetchInviteLink"),[e,a]=(0,i.useState)(null),n=(0,i.useRef)(null),[r,{loading:o,error:s}]=p(Q,{fetchPolicy:"network-only",onError:e=>{t.errorToTelemetry(`Error while fetching invite link: ${e.message}`,"tfl_onboarding_generic_error"),n.current&&(n.current(null),n.current=null)},onCompleted:e=>{const i=e?.userInviteLink||"";i?(a(i),n.current&&(n.current(i),n.current=null)):(t.errorToTelemetry("No invite link returned from server","tfl_onboarding_generic_error"),n.current&&(n.current(null),n.current=null))}});return{onInviteToChatHandler:(0,i.useCallback)((()=>(a(null),r(),new Promise((t=>{n.current=t})))),[r]),inviteLink:e,loading:o,error:s}}(),j=r().useCallback((async()=>await v()),[v]);return(0,n.jsxs)(T,{className:c.paneWrapper,column:!0,vAlign:"center",children:[!_&&!y&&(0,n.jsxs)(T,{className:c.headerContainer,column:!0,hAlign:"center",vAlign:"center",children:[(0,n.jsx)(o.E,{className:c.cardTitle,weight:"bold",align:"center",children:m.translate("messaging","smb_chat_zero_state_title",{name:w})}),(0,n.jsx)(o.E,{size:300,align:"center",children:m.translate("messaging","chat_empty_state_welcome_subtitle")})]}),(0,n.jsx)(T,{className:_&&!y?(0,s.z)(c.cardsWrapper,c.singleCardWrapper):c.cardsWrapper,column:!0,hAlign:"center",vAlign:"center",children:(0,n.jsx)("div",{className:c.cardsContainer,children:_||y?(0,n.jsx)(M,{imageUrl:`${nt}/evergreen-assets/illustrations/webp/256/avatar-add-${it[a]}-standard-256x256.webp`,title:C,subtitle:S,buttonText:m.translate("messaging","chat_empty_state_invite_via_link_button"),buttonAppearance:B.b.Primary,isSingleCta:_||y,loadingStateText:m.translate("messaging","chat_empty_state_loading_state"),successStateText:m.translate("messaging","chat_empty_state_success_state"),errorStateText:m.translate("messaging","chat_empty_state_invite_to_chat_generic_error"),onClick:j,dataTid:"chat-zero-state-sidecar-invite-to-chat",telemetry:lt}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(M,{imageUrl:`${nt}/evergreen-assets/illustrations/webp/256/chat-${it[a]}-standard-256x256.webp`,subtitle:m.translate("messaging","chat_empty_state_new_chat_subtitle"),buttonText:m.translate("messaging","chat_empty_state_new_chat_button"),onClick:b,dataTid:"chat-zero-state-sidecar-start-chat",telemetry:ot}),h&&e&&!x&&(0,n.jsx)(M,{imageUrl:`${nt}/evergreen-assets/illustrations/webp/256/meet-${it[a]}-standard-256x256.webp`,subtitle:m.translate("messaging","chat_empty_state_meet_now_subtitle"),button:(0,n.jsx)(e,{primary:!1}),dataTid:"chat-zero-state-sidecar-meet-now"}),x&&(0,n.jsx)(M,{imageUrl:`${nt}/evergreen-assets/illustrations/webp/256/avatar-add-${it[a]}-standard-256x256.webp`,subtitle:m.translate("messaging","chat_empty_state_invite_to_chat_subtitle"),buttonText:m.translate("messaging","chat_empty_state_invite_to_chat_button"),loadingStateText:m.translate("messaging","chat_empty_state_loading_state"),successStateText:m.translate("messaging","chat_empty_state_success_state"),errorStateText:m.translate("messaging","chat_empty_state_invite_to_chat_generic_error"),onClick:j,dataTid:"chat-zero-state-sidecar-invite-to-chat",telemetry:st})]})})}),!y&&(0,n.jsx)(T,{className:c.footerContainer,column:!0,hAlign:"center",children:(0,n.jsx)(o.E,{size:300,weight:"regular",align:"center",children:(0,n.jsx)(g,{i18nKey:"chat_empty_state_mobile_description",children:(0,n.jsx)("a",{className:c.footerLink,href:at,target:"_blank",rel:"noreferrer",...ct,"data-tid":"chat-zero-state-sidecar-get-mobile-link",children:{link:m.translate("messaging","chat_empty_state_mobile_app_title")}})})})})]})}},1603:(t,e,a)=>{a.d(e,{Id:()=>r,U:()=>n,b:()=>o});const n="chat-zero-state",i="3.10.15"==="3.10.15"?"3.10.15":`${"3.10.15"}_${"3.10.15"}`,r=`${n}_default_${i}`;var o=function(t){return t.Primary="primary",t.Outline="outline",t.Subtle="subtle",t.Transparent="transparent",t}({})},7274:(t,e,a)=>{a.r(e),a.d(e,{Id:()=>i.Id,SidecarChatZeroState:()=>n.L});var n=a(973),i=a(1603)}}]);
//# sourceMappingURL=575.js.map